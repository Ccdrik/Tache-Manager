<div class="tasks-header">
    <h2>Mes tâches</h2>
    <div class="task-actions-header">
        <button class="btn-add" (click)="addTask()">+ Tâche rapide</button>
        <button class="btn-add" [routerLink]="'/taches/ajouter'">+ Nouvelle tâche avancée</button>
    </div>
</div>

<!-- Filtres -->
<div class="filters">
    <div class="filter-buttons">
        <button class="filter-btn" [class.active]="filter === 'all'"
            (click)="filter='all'; applyFilter()">Toutes</button>
        <button class="filter-btn" [class.active]="filter === 'undone'" (click)="filter='undone'; applyFilter()">À
            faire</button>
        <button class="filter-btn" [class.active]="filter === 'done'"
            (click)="filter='done'; applyFilter()">Terminées</button>
    </div>

    <div class="filter-options">
        <label>
            Filtrer par date :
            <input type="date" [(ngModel)]="selectedDate" (change)="applyFilter()">
        </label>

        <button class="sort-btn" (click)="toggleSortOrder()">
            Trier : {{ sortDescending ? 'Récent → Ancien' : 'Ancien → Récent' }}
        </button>
    </div>
</div>

<!-- Liste des tâches -->
<ul class="task-list">
    <li *ngFor="let task of tasks" class="task-item" [class.completed]="task.faite">
        <div class="task-info">
            <h3>{{ task.titre }}</h3>
            <p *ngIf="task.description">{{ task.description }}</p>
            <span class="task-date">{{ task.date | date:'dd/MM/yyyy' }}</span>

            <!-- Checklist -->
            <div *ngIf="task.checklist && task.checklist.length > 0" class="checklist">
                <label *ngFor="let item of task.checklist; let i = index">
                    <input type="checkbox" [checked]="item.checked" (change)="toggleChecklistItem(task, i)">
                    {{ item.label }}
                </label>
            </div>
        </div>

        <div class="task-actions">
            <button class="btn-done" (click)="toggleDone(task)">✔</button>
            <button class="btn-edit" (click)="editTask(task)">✎</button>
            <button class="btn-delete" *ngIf="task.id !== undefined" (click)="deleteTask(task.id)">🗑</button>
        </div>
    </li>
</ul>

<!-- Alert -->
<app-alert *ngIf="alertMessage" [type]="alertType" [message]="alertMessage"></app-alert>